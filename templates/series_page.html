{% extends "base.html" %}

{% block body %}


<div class="row">
    <div class="col-md-8">
        <img class="img-responsive series-fanart" src="{{series.fanart}}">
    </div>
     <div class ="col-md-4">
        <h2 class='series-title'>{{series.title}}</h2>
        <p class="series-overview">{{series.overview}}</p>

    </div>

</div>

<hr>

<div class = "row">
    
     <div class="user-buttons col-md-6">
        <div class="btn-group" data-toggle="buttons">
          <label class="btn btn-default" id="watching">
            <input type="radio"  value="option1">
            Currently Watching
          </label>
          <label class="btn btn-default" id="watched">
            <input type="radio"  value="option2">
            Watched
          </label>
          <label class="btn btn-default" id="to-watch">
            <input type="radio"  value="option3">
            Want to Watch
          </label>
          <button type="button" class="btn btn-default" id="favorite">Favorite</button>
        </div>
    </div>

    <div class="season-buttons col-md-6">
        <div class="btn-group" data-toggle="buttons">
          <label class="btn btn-default" id="1">
            <input type="radio"  value="option1">
            1
          </label>
        </div>
         
    </div>

</div>




<div class="row col-md-12">
    <div class="col-md-6"></div>
    <div class="episodes-table col-md-6">
        <table class="table table-hover">
            <thead>
                <tr>
                    <th>#</th>
                    <th>Episode Title</th>
                    <th>Watched</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>1</td>
                    <td>Pilot</td>
                    <td>
                        <button type="button" class="btn btn-default btn-sm">
                            <span class="glyphicon glyphicon-unchecked"></span>
                        </button>
                    </td>
                </tr>
                <tr>
                    <td>2</td>
                    <td>Blood Moon</td>
                    <td><span class="glyphicon glyphicon-ok"></span></td>
                </tr>
            </tbody>
        </table>

    </div>

</div>





<script type="text/javascript">
    var my_episodes = {{ episodes | safe }};
    $('.btn-group').button()

    if ("{{state}}" == "watching") {
        $("#watching").button('toggle');
    };

    if ("{{state}}" == "watched") {
       $("#watched").button('toggle');
    };

    if ("{{state}}" == "to-watch") {
        $("#to-watch").button('toggle');
    };

    $('#watching').click(update_show_state_to_watching);
    $('#watched').click(update_show_state_to_watched);
    $('#to-watch').click(update_show_state_want_to_watch);
    
     $('#favorite').click(function(e) {
        console.log('link clicked!');
        var seriesId = {{series.id}};
        var userId = {{current_user.id}};
        $.post("/add-fav-series", {series_id:seriesId, user_id:userId});

    });

   

    function change_show_state(state){
        console.log('link clicked!');
        var seriesId = {{series.id}};
        var userId = {{current_user.id}};
        var state = state;
        $.post("/add-user-series", {series_id:seriesId, user_id:userId, state:state});  
    }

    function update_show_state_to_watching(evt){
        change_show_state("watching");
    }

    function update_show_state_to_watched(evt){
        change_show_state("watched");
    }

    function update_show_state_want_to_watch(evt){
        change_show_state("to-watch");
    }



   


</script>
{% endblock %}
